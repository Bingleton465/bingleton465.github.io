<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Velora - ⚙️</title>
  <link id="favicon" rel="icon" href="favicon.ico">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      overflow-y: auto;
      background: black;
      font-family: Arial, sans-serif;
    }

    /* ... rest of your existing CSS ... */
  </style>
</head>
<body>
  <div class="top-bar">
    <!-- your top-bar markup -->
  </div>

  <div class="settings-container">
    <!-- your settings markup -->
  </div>

  <a href="https://discord.gg/R9xCcQFBhf" target="_blank" class="discord-link">
    <img src="https://logodownload.org/wp-content/uploads/2017/11/discord-logo-7-1.png" alt="Discord Logo" class="discord-logo">
  </a>

  <script>
    // Cookie helpers
    function setCookie(name, value, days = 30) {
      const expires = new Date(Date.now() + days * 864e5).toUTCString();
      document.cookie = name + '=' + encodeURIComponent(value) + '; path=/; expires=' + expires;
    }

    function getCookie(name) {
      return document.cookie.split('; ').reduce((r, v) => {
        const parts = v.split('=');
        return parts[0] === name ? decodeURIComponent(parts[1]) : r
      }, '');
    }

    // Load on page open
    window.addEventListener('DOMContentLoaded', () => {
      // 1. localStorage
      let title = localStorage.getItem('customTitle');
      let icon  = localStorage.getItem('customFavicon');
      // 2. fallback to cookies if localStorage empty
      if (!title) title = getCookie('customTitle');
      if (!icon)  icon  = getCookie('customFavicon');

      if (title) {
        document.title = title;
        document.getElementById('title-input').value = title;
      }
      if (icon) {
        document.getElementById('favicon').href = icon;
      }
    });

    // Title input listener
    const titleInput = document.getElementById('title-input');
    titleInput.addEventListener('input', () => {
      const val = titleInput.value;
      document.title = val;
      localStorage.setItem('customTitle', val);
      setCookie('customTitle', val);
    });

    // Favicon file change
    document.getElementById('favicon-input').addEventListener('change', (e) => {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onloadend = () => {
        const url = reader.result;
        document.getElementById('favicon').href = url;
        localStorage.setItem('customFavicon', url);
        setCookie('customFavicon', url);
      };
      if (file) reader.readAsDataURL(file);
    });

    // Cloak button
    document.getElementById('cloak-btn').addEventListener('click', () => setCloak());

    function setCloak() {
      const cloak = document.getElementById('premadecloaks').value;
      const titles = { /* your titles map */ };
      const favicons = { /* your favicons map */ };
      const newTitle = titles[cloak];
      const newIcon  = favicons[cloak];
      document.title = newTitle;
      document.getElementById('favicon').href = newIcon;
      localStorage.setItem('customTitle', newTitle);
      localStorage.setItem('customFavicon', newIcon);
      setCookie('customTitle', newTitle);
      setCookie('customFavicon', newIcon);
      location.reload();
    }

    // Reset button
    document.getElementById('reset-settings-btn').addEventListener('click', () => {
      localStorage.removeItem('customTitle');
      localStorage.removeItem('customFavicon');
      setCookie('customTitle', '', -1);
      setCookie('customFavicon', '', -1);

      document.title = 'Velora';
      document.getElementById('favicon').href = 'favicon.ico';
      document.getElementById('title-input').value = '';
      document.getElementById('favicon-input').value = '';
    });

    // Optional: listen for storage changes in other tabs
    window.addEventListener('storage', (e) => {
      if (e.key === 'customTitle') document.title = e.newValue || 'Velora';
      if (e.key === 'customFavicon') document.getElementById('favicon').href = e.newValue || 'favicon.ico';
    });

    // aboutBlank function remains unchanged
  </script>
</body>
</html>
